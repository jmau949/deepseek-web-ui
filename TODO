socket reconnect and performance optimize
style